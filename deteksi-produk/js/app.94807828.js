(function(e){function t(t){for(var n,r,s=t[0],o=t[1],l=t[2],u=0,b=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&b.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);d&&d(t);while(b.length)b.shift()();return a.push.apply(a,l||[]),c()}function c(){for(var e,t=0;t<a.length;t++){for(var c=a[t],n=!0,s=1;s<c.length;s++){var o=c[s];0!==i[o]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=c[0]))}return e}var n={},i={app:0},a=[];function r(t){if(n[t])return n[t].exports;var c=n[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,r),c.l=!0,c.exports}r.m=e,r.c=n,r.d=function(e,t,c){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(r.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(c,n,function(t){return e[t]}.bind(null,n));return c},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=o;a.push([0,"chunk-vendors"]),c()})({0:function(e,t,c){e.exports=c("56d7")},"0a9c":function(e,t,c){"use strict";c("0dcb")},"0dcb":function(e,t,c){},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,c){"use strict";c.r(t);c("e260"),c("e6cf"),c("cca6"),c("a79d");var n=c("7a23"),i=(c("b0c0"),c("b680"),{class:"card flex-row main-container"}),a={class:"flex-col w-50 grey darken-2"},r={id:"image_wrapper",class:"image-wrapper flex-fill"},s=["src"],o=["src","alt"],l={key:0,class:"image-title"},d=["onClick"],u={class:"valign-wrapper"},b=Object(n["e"])("i",{class:"material-icons mr-2"},"close",-1),p={class:"predicted-mask"},f={id:"prediction-result"},g={class:"loading-mask white-text"},m=Object(n["f"])('<div class="preloader-wrapper big active"><div class="spinner-layer spinner-blue-only"><div class="circle-clipper left"><div class="circle"></div></div><div class="gap-patch"><div class="circle"></div></div><div class="circle-clipper right"><div class="circle"></div></div></div></div><h6>Memproses</h6>',2),j=[m],h={class:"flex-col insert-image"},O=Object(n["e"])("i",{class:"material-icons grey-text text-darken-3"},"add_a_photo",-1),v=Object(n["e"])("a",{class:"btn waves-effect waves-light"},[Object(n["e"])("label",{class:"valign-wrapper white-text",for:"image_input",style:{"font-size":"14px"}},[Object(n["e"])("i",{class:"material-icons mr-2"},"add"),Object(n["g"])(" Input gambar ")])],-1),x=[O,v],y={class:"flex-col w-50"},w={class:"card-content flex-fill"},k={class:"green-text valign-wrapper",style:{height:"2rem"}},_={key:0,class:"material-icons mr-2"},I={key:1,class:"loader mr-2"},L={class:"right-align grey-text text-darken-3 invoice-total"},R=Object(n["e"])("h6",null,"Total",-1),P=Object(n["e"])("div",{class:"divider grey darken-3 my-4"},null,-1),M={id:"table-wrapper"},B={id:"table-scroll"},C=Object(n["e"])("thead",null,[Object(n["e"])("tr",null,[Object(n["e"])("th",{class:"col-num"},[Object(n["e"])("span",{class:"text"})]),Object(n["e"])("th",{class:"col-title"},[Object(n["e"])("span",{class:"text"},"Nama Item")]),Object(n["e"])("th",{class:"col-accuracy"},[Object(n["e"])("span",{class:"text"},"Akurasi")]),Object(n["e"])("th",{class:"col-price"},[Object(n["e"])("span",{class:"text"},"Harga")])])],-1),S={key:0},D=Object(n["e"])("td",{class:"center-align grey-text",colspan:"5"},[Object(n["e"])("i",{class:"material-icons",style:{"font-size":"5rem"}},"production_quantity_limits"),Object(n["e"])("h5",{style:{"font-size":"1.64rem"}}," Tidak ada barang ")],-1),T=[D],E={class:"col-num"},F={class:"col-title"},z={class:"col-accuracy"},W={class:"col-price"},H={class:"card-action"},q={key:0,class:"btn waves-effect waves-light mx-1 red"},A=Object(n["e"])("span",{class:"valign-wrapper"},[Object(n["e"])("i",{class:"material-icons mr-2"},"close"),Object(n["g"])(" Batal ")],-1),N=[A],U=Object(n["e"])("span",{class:"valign-wrapper"},[Object(n["e"])("i",{class:"material-icons mr-2"},"filter_center_focus"),Object(n["g"])(" Deteksi ")],-1),$=[U],J=Object(n["e"])("span",{class:"valign-wrapper"},[Object(n["e"])("i",{class:"material-icons mr-2"},"shopping_cart"),Object(n["g"])(" Checkout ")],-1),G=[J],K=Object(n["e"])("span",{class:"valign-wrapper"},[Object(n["e"])("i",{class:"material-icons mr-2"},"cached"),Object(n["g"])(" Reset ")],-1),Q=[K],V={key:2};function X(e,t,c,m,O,v){return Object(n["j"])(),Object(n["d"])(n["a"],null,[Object(n["e"])("input",{type:"file",name:"image_input",ref:"ref_image_input",id:"image_input",onChange:t[0]||(t[0]=function(){return v.fileChanged&&v.fileChanged.apply(v,arguments)}),accept:"image/jpg, image/jpeg, image/png"},null,544),Object(n["e"])("div",i,[Object(n["e"])("div",a,[Object(n["e"])("div",r,[Object(n["n"])(Object(n["e"])("img",{id:"predict-image",src:O.image_url,alt:"Image",onLoad:t[1]||(t[1]=function(){return v.ImageLoad&&v.ImageLoad.apply(v,arguments)})},null,40,s),[[n["m"],O.isImageLoaded]]),(Object(n["j"])(!0),Object(n["d"])(n["a"],null,Object(n["k"])(O.detectionBox,(function(e,t){return Object(n["n"])((Object(n["j"])(),Object(n["d"])("img",{src:e,alt:t,key:t},null,8,o)),[[n["m"],O.isPredicted&&!O.detection[t].hide]])})),128)),O.isPredicted?(Object(n["j"])(),Object(n["d"])("span",l,[(Object(n["j"])(!0),Object(n["d"])(n["a"],null,Object(n["k"])(v.groupedItems,(function(e,t){return Object(n["j"])(),Object(n["d"])("a",{class:"btn btn-small mr-2",key:t,style:Object(n["i"])("background-color: "+e.color),onClick:function(t){return v.hideDetection(e.id)}},[Object(n["e"])("span",u,[b,Object(n["g"])(" "+Object(n["l"])(e.name)+" ("+Object(n["l"])(e.count)+") ",1)])],12,d)})),128))])):Object(n["c"])("",!0),Object(n["n"])(Object(n["e"])("div",p,[Object(n["n"])(Object(n["e"])("canvas",f,null,512),[[n["m"],!1]])],512),[[n["m"],O.isPredicted]]),Object(n["n"])(Object(n["e"])("div",g,j,512),[[n["m"],O.isPredicting]]),Object(n["n"])(Object(n["e"])("div",h,x,512),[[n["m"],!O.isImageLoaded]])])]),Object(n["e"])("div",y,[Object(n["e"])("div",w,[Object(n["e"])("h6",k,[O.isLoadingModel?(Object(n["j"])(),Object(n["d"])("span",I)):(Object(n["j"])(),Object(n["d"])("i",_,"check_circle")),Object(n["e"])("span",null,Object(n["l"])(O.isLoadingModel?"Loading Model":"Models Loaded"),1)]),Object(n["e"])("div",L,[R,Object(n["e"])("h3",null,"Rp."+Object(n["l"])(v.numFormat(v.invoiceDetails.total,2,3))+"-",1)]),P,Object(n["e"])("div",M,[Object(n["e"])("div",B,[Object(n["e"])("table",null,[C,Object(n["e"])("tbody",null,[O.invoice.length?(Object(n["j"])(!0),Object(n["d"])(n["a"],{key:1},Object(n["k"])(O.detection,(function(e,t){return Object(n["j"])(),Object(n["d"])("tr",{key:t},[Object(n["e"])("td",E,Object(n["l"])(t+1),1),Object(n["e"])("td",F,Object(n["l"])(e.class.name),1),Object(n["e"])("td",z,Object(n["l"])(parseFloat(100*e.score).toFixed(1))+"%",1),Object(n["e"])("td",W,"Rp."+Object(n["l"])(v.numFormat(e.class.price,0,3)),1)])})),128)):(Object(n["j"])(),Object(n["d"])("tr",S,T))])])])])]),Object(n["e"])("div",H,[O.isPredicting?(Object(n["j"])(),Object(n["d"])("a",q,N)):(Object(n["j"])(),Object(n["d"])("a",{key:1,class:Object(n["h"])(["btn waves-effect waves-light mx-1",{disabled:!O.isImageLoaded||O.isPredicted}]),onClick:t[2]||(t[2]=function(){return v.predict&&v.predict.apply(v,arguments)})},$,2)),Object(n["n"])(Object(n["e"])("a",{class:"btn waves-effect waves-light mx-1",onClick:t[3]||(t[3]=function(){return e.debig&&e.debig.apply(e,arguments)})},G,512),[[n["m"],!1]]),Object(n["e"])("a",{class:Object(n["h"])(["btn waves-effect waves-light blue mx-1",{disabled:!O.isImageLoaded}]),onClick:t[4]||(t[4]=function(){return v.clearImage&&v.clearImage.apply(v,arguments)})},Q,2),O.predictionTime?(Object(n["j"])(),Object(n["d"])("span",V,[Object(n["e"])("i",null,"Waktu Deteksi : "+Object(n["l"])(O.predictionTime)+" ms",1)])):Object(n["c"])("",!0)])])])],64)}var Y=c("5530"),Z=c("1da1"),ee=(c("96cf"),c("dca8"),c("d3b7"),c("159b"),c("a434"),c("3ca3"),c("ddb0"),c("2b3d"),c("9861"),c("ac1f"),c("5319"),c("4d63"),c("c607"),c("2c3e"),c("25f0"),c("99af"),c("ce1a"));ee["c"]("webgl");var te=function(){var e=Object(Z["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ee["b"](t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(Z["a"])(regeneratorRuntime.mark((function e(t){var c,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=ee["a"].fromPixels(t).toInt(),n=c.transpose([0,1,2]).expandDims(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(e){var t=e.scores,c=e.threshold,n=e.boxes,i=e.classes,a=e.classesDir,r=e.frame,s=[];return t[0].forEach((function(e,t){if(e>c){var o=[],l=n[0][t][0]*r.offsetHeight,d=n[0][t][1]*r.offsetWidth,u=n[0][t][2]*r.offsetHeight,b=n[0][t][3]*r.offsetWidth;o[0]=d,o[1]=l,o[2]=b-d,o[3]=u-l,s.push({class:a[i[t]],score:e.toFixed(4),bbox:o})}})),s},ie=function(e,t,c,n){return ne({classes:e[0].dataSync(),scores:e[1].arraySync(),boxes:e[5].arraySync(),classesDir:c,threshold:t,frame:n})},ae={name:"App",data:function(){return{model:null,isLoadingModel:!1,detection:[],detectionBox:[],image_url:"",imageSize:{width:0,height:0},isImageLoaded:!1,isPredicting:!1,invoice:[],isPredicted:!1,isLoading:!1,classes:[],base_url:"./",predictionTime:void 0}},watch:{detection:function(e){this.detectionBox=[];for(var t=0;t<e.length;t++){var c=e[t];this.detectionBox.push(this.renderBoundingBox(c))}}},methods:{loadModel:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoadingModel=!0,t.t0=Object,t.next=4,te(e.base_url+"model/model.json");case 4:t.t1=t.sent,e.model=t.t0.freeze.call(t.t0,t.t1),e.isLoadingModel=!1;case 7:case"end":return t.stop()}}),t)})))()},loadClasses:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.base_url+"product_data.json").then((function(e){return e.json()}));case 2:e.classes=t.sent;case 3:case"end":return t.stop()}}),t)})))()},init:function(){this.isPredicted=!1,this.image_url=this.base_url+"product.png"},addInvoiceItems:function(e){var t=this;e.forEach((function(e){for(var c=!1,n=0;n<t.invoice.length;n++)if(e.class.id==t.invoice[n].id){c=!0,t.invoice[n].quantity++;break}c||t.invoice.push(Object(Y["a"])(Object(Y["a"])({},e.class),{},{quantity:1}))}))},deleteInvoice:function(e){this.invoice.length>-1&&this.invoice.splice(e,1)},fileChanged:function(e){var t=e.target.files[0];this.image_url=URL.createObjectURL(t),""!=this.image_url&&(this.isImageLoaded=!0)},predict:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var c,n,i,a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(c=Date.now(),e.isPredicting=!0,e.isPredicted=!1,e.isLoading=!0,n=document.getElementById("predict-image"),e.isModelLoaded){t.next=7;break}return t.abrupt("return");case 7:return t.t0=e.model,t.next=10,ce(n);case 10:return t.t1=t.sent,t.next=13,t.t0.executeAsync.call(t.t0,t.t1);case 13:i=t.sent,a=ie(i,.5,e.classes,n),a.length>0&&(console.log("object detected",a),e.addInvoiceItems(a),e.detection=a,e.isPredicted=!0,r=Date.now(),s=r-c,e.predictionTime=s,console.log({predict_time:s})),e.isLoading=!1,e.isPredicting=!1;case 18:case"end":return t.stop()}}),t)})))()},clearImage:function(){this.detection=[],this.$refs.ref_image_input.value=null,this.image_url="",this.isImageLoaded=!1,this.imageSize={width:0,height:0},this.isPredicted=!1,this.invoice=[],this.predictionTime=void 0},ImageLoad:function(e){var t=e.target,c=t.width,n=t.height,i=document.getElementById("image_wrapper").getBoundingClientRect();c<i.width&&n<i.height&&document.getElementById("predict-image").classList.add("h-100"),this.imageSize},numFormat:function(e,t,c){if(isNaN(e))return"-";var n="\\d(?=(\\d{"+(c||3)+"})+"+(t>0?"\\.":"$")+")";return e.toFixed(Math.max(0,~~t)).replace(new RegExp(n,"g"),"$&,")},renderBoundingBox:function(e){var t=document.getElementById("prediction-result"),c=document.getElementById("predict-image");t.width=c.offsetWidth,t.height=c.offsetHeight;var n=t.getContext("2d");n.clearRect(0,0,n.canvas.width,n.canvas.height);var i="16px sans-serif";n.font=i,n.textBaseline="top";var a=e.bbox[0],r=e.bbox[1],s=e.bbox[2],o=e.bbox[3],l=(100*e.score).toFixed(2),d="".concat(e.class.name," ").concat(l,"%");n.strokeStyle=e.class.color,n.lineWidth=3,n.strokeRect(a,r+1,s,o),n.fillStyle=e.class.color;var u=n.measureText(d).width,b=parseInt(i,7);return n.fillRect(a,r,u+5,b+5),n.fillStyle="#ffffff",n.fillText(d,a+2,r+2),t.toDataURL("image/png")},hideDetection:function(e){this.detection.forEach((function(t){t.class.id==e&&(t.hide=!t.hide)}))}},computed:{invoiceDetails:function(){return{items:this.detection.length,total:this.groupedItems.reduce((function(e,t){return e+t.price*t.count}),0)}},isModelLoaded:function(){return null!=this.model},groupedItems:function(){for(var e=[],t=0;t<this.detection.length;t++){for(var c=!1,n=0;n<e.length;n++)e[n].id==this.detection[t].class.id&&(c=!0,e[n].count++);c||e.push(Object(Y["a"])(Object(Y["a"])({},this.detection[t].class),{},{count:1}))}return e}},mounted:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.init(),e.isLoading=!0,t.next=4,e.loadModel();case 4:return t.next=6,e.loadClasses();case 6:e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()}},re=(c("0a9c"),c("6b0d")),se=c.n(re);const oe=se()(ae,[["render",X]]);var le=oe;c("dc53"),c("3108");Object(n["b"])(le).mount("#app")},6:function(e,t){},7:function(e,t){}});
//# sourceMappingURL=app.94807828.js.map